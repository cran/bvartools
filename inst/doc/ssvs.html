<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Franz X. Mohr" />

<meta name="date" content="2023-08-30" />

<title>Stochastic Search Variable Selection in bvartools</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Stochastic Search Variable Selection in
bvartools</h1>
<h4 class="author">Franz X. Mohr</h4>
<h4 class="date">2023-08-30</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>A general drawback of vector autoregressive (VAR) models is that the
number of estimated coefficients increases disproportionately with the
number of lags. Therefore, fewer information per parameter is available
for the estimation as the number of lags increases. In the Bayesian VAR
literature one approach to mitigate this so-called <em>curse of
dimensionality</em> is <em>stochastic search variable selection</em>
(SSVS) as proposed by George et al. (2008). The basic idea of SSVS is to
assign commonly used prior variances to parameters, which should be
included in a model, and prior variances close to zero to irrelevant
parameters. By that, relevant parameters are estimated in the usual way
and posterior draws of irrelevant variables are close to zero so that
they have no significant effect on forecasts and impulse responses. This
is achieved by adding a hierarchial prior to the model, where the
relevance of a variable is assessed in each step of the sampling
algorithm.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>Korobilis (2013) proposes a similar appraoch to variable selection,
which can also be applied to timy varying parameter models. The approach
is implemented in <code>bvartools</code> as function <code>bvs</code>,
which can be easily added to a standard Gibbs sampling algorithm. It is
also implemented in the posterior simulation algorithm of the package an
can be specified analogously to the last section of this introduction,
where the use of the built-in SSVS sampler is described.</p>
<p>This vignette presents code for Bayesian inference of a vector
autoregressive (BVAR) model using stochastic search variable selection.
It uses <a href="http://www.jmulti.de/download/datasets/e1.dat">dataset
E1</a> from Lütkepohl (2006), which contains data on West German fixed
investment, disposable income and consumption expenditures in billions
of DM from 1960Q1 to 1982Q4. Following a related example in Lütkepohl
(2006, Section 5.2.10) only the first 71 observations of a VAR(4) model
are used. The <code>bvartools</code> package can be used to load the
data and generate the data matrices for the model.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(bvartools)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Load and transform data</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;e1&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(e1))</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># Shorten time series</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> <span class="fu">window</span>(e1, <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">1978</span>, <span class="dv">4</span>))</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># Generate VAR</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">gen_var</span>(e1, <span class="at">p =</span> <span class="dv">4</span>, <span class="at">deterministic =</span> <span class="st">&quot;const&quot;</span>,</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>                <span class="at">iterations =</span> <span class="dv">10000</span>, <span class="at">burnin =</span> <span class="dv">5000</span>)</span></code></pre></div>
<p><code>bvartools</code> allows to estimate BVAR models with SSVS
either by using algorithms that were written by the researchers
themselves or by using the built-in posterior simulation algorithm. The
first approach is presented in the following section. The latter
approach is illustrated at the end of this introduction.</p>
</div>
<div id="inference-based-on-a-user-written-algorithm" class="section level2">
<h2>Inference based on a user-written algorithm</h2>
<p>The prior variances of the parameters are set in accordance with the
semiautomatic approach described in George et al. (2008). Hence, the
prior variance of the <span class="math inline">\(i\)</span>th parameter
is set to <span class="math inline">\(\tau_{1,i}^2 = (10
\hat{\sigma}_i)^2\)</span> if this parameter should be included in the
model and to <span class="math inline">\(\tau_{0,i}^2 = (0.1
\hat{\sigma}_i)^2\)</span> if it should be excluded. <span class="math inline">\(\hat{\sigma}_i\)</span> is the standard error
associated with the unconstrained least squares estimate of parameter
<span class="math inline">\(i\)</span>. For all variables the prior
inclusion probabilities are set to 0.5. The necessary calculations can
be done with function <code>ssvs_prior</code>. The prior of the error
variance-covariance matrix is uninformative and, in constrast to George
et al. (2008), SSVS is not applied to the covariances.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Reset random number generator for reproducibility</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234567</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># Get data matrices</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">t</span>(data<span class="sc">$</span>data<span class="sc">$</span>Y)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">t</span>(data<span class="sc">$</span>data<span class="sc">$</span>Z)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">ncol</span>(y) <span class="co"># Number of observations</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(y) <span class="co"># Number of endogenous variables</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>m <span class="ot">&lt;-</span> k <span class="sc">*</span> <span class="fu">nrow</span>(x) <span class="co"># Number of estimated coefficients</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co"># Coefficient priors</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>a_mu_prior <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m) <span class="co"># Vector of prior means</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co"># SSVS priors (semiautomatic approach)</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>vs_prior <span class="ot">&lt;-</span> <span class="fu">ssvs_prior</span>(data, <span class="at">semiautomatic =</span> <span class="fu">c</span>(.<span class="dv">1</span>, <span class="dv">10</span>))</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>tau0 <span class="ot">&lt;-</span> vs_prior<span class="sc">$</span>tau0</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>tau1 <span class="ot">&lt;-</span> vs_prior<span class="sc">$</span>tau1</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co"># Prior for inclusion parameter</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>prob_prior <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fl">0.5</span>, m)</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co"># Prior for variance-covariance matrix</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>u_sigma_df_prior <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Prior degrees of freedom</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>u_sigma_scale_prior <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fl">0.00001</span>, k) <span class="co"># Prior covariance matrix</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>u_sigma_df_post <span class="ot">&lt;-</span> tt <span class="sc">+</span> u_sigma_df_prior <span class="co"># Posterior degrees of freedom</span></span></code></pre></div>
<p>The initial parameter values are set to zero and their corresponding
prior variances are set to <span class="math inline">\(\tau_1^2\)</span>, which implies that all
parameters should be estimated relatively freely in the first step of
the Gibbs sampler.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>a_v_i_prior <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">c</span>(tau1)<span class="sc">^</span><span class="dv">2</span>, m) <span class="co"># Inverse of the prior covariance matrix</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># Data containers for posterior draws</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># Number of total Gibs sampler draws</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>burnin <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co"># Number of burn-in draws</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>draws <span class="ot">&lt;-</span> iterations <span class="sc">+</span> burnin <span class="co"># Total number of draws</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>draws_a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, m, iterations)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>draws_lambda <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, m, iterations)</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>draws_sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, k<span class="sc">^</span><span class="dv">2</span>, iterations)</span></code></pre></div>
<p>SSVS can be added to a standard Gibbs sampler algorithm for VAR
models in a straightforward manner. The <code>ssvs</code> function can
be used to obtain a draw of inclusion parameters and its corresponding
inverted prior variance matrix. It requires the current draw of
parameters, standard errors <span class="math inline">\(\tau_0\)</span>
and <span class="math inline">\(\tau_1\)</span>, and prior inclusion
probabilities as arguments. In this example constant terms are excluded
from SSVS, which is achieved by specifying <code>include = 1:36</code>.
Hence, only parameters 1 to 36 are considered by the function and the
remaining three parameters have prior variances that correspond to their
values in <span class="math inline">\(\tau_1^2\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Start Gibbs sampler</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="cf">for</span> (draw <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>draws) {</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="co"># Draw variance-covariance matrix</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  u <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">matrix</span>(a, k) <span class="sc">%*%</span> x <span class="co"># Obtain residuals</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="co"># Scale posterior</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  u_sigma_scale_post <span class="ot">&lt;-</span> <span class="fu">solve</span>(u_sigma_scale_prior <span class="sc">+</span> <span class="fu">tcrossprod</span>(u))</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="co"># Draw posterior of inverse sigma</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  u_sigma_i <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rWishart</span>(<span class="dv">1</span>, u_sigma_df_post, u_sigma_scale_post)[,, <span class="dv">1</span>], k)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="co"># Obtain sigma</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  u_sigma <span class="ot">&lt;-</span> <span class="fu">solve</span>(u_sigma_i)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  </span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="co"># Draw conditional mean parameters</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">post_normal</span>(y, x, u_sigma_i, a_mu_prior, a_v_i_prior)</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  </span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="co"># Draw inclusion parameters and update priors</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">ssvs</span>(a, tau0, tau1, prob_prior, <span class="at">include =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">36</span>)</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  a_v_i_prior <span class="ot">&lt;-</span> temp<span class="sc">$</span>v_i <span class="co"># Update prior</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>  </span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>  <span class="co"># Store draws</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  <span class="cf">if</span> (draw <span class="sc">&gt;</span> burnin) {</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>    draws_a[, draw <span class="sc">-</span> burnin] <span class="ot">&lt;-</span> a</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>    draws_lambda[, draw <span class="sc">-</span> burnin] <span class="ot">&lt;-</span> temp<span class="sc">$</span>lambda</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>    draws_sigma[, draw <span class="sc">-</span> burnin] <span class="ot">&lt;-</span> u_sigma</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>  }</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>}</span></code></pre></div>
<p>The output of a Gibbs sampler with SSVS can be further analysed in
the usual way. With the <code>bvartools</code> package the posterior
draws can be collected in a <code>bvar</code> object and the
<code>summary</code> method provides summary statistics. It is also
possible to add information on the inclusion parameters to the
<code>bvar</code> object by providing a named list as an argument. The
list must contain an element <code>coeffs</code>, which contains the
MCMC draws of the coefficients, and element <code>lambda</code> contains
the corresponding draw of the inclusion parameter.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>bvar_est <span class="ot">&lt;-</span> <span class="fu">bvar</span>(<span class="at">y =</span> data<span class="sc">$</span>data<span class="sc">$</span>Y, <span class="at">x =</span> data<span class="sc">$</span>data<span class="sc">$</span>Z,</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                 <span class="at">A =</span> <span class="fu">list</span>(<span class="at">coeffs =</span> draws_a[<span class="dv">1</span><span class="sc">:</span><span class="dv">36</span>,],</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                          <span class="at">lambda =</span> draws_lambda[<span class="dv">1</span><span class="sc">:</span><span class="dv">36</span>,]),</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                 <span class="at">C =</span> <span class="fu">list</span>(<span class="at">coeffs =</span> draws_a[<span class="dv">37</span><span class="sc">:</span><span class="dv">39</span>, ],</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>                          <span class="at">lambda =</span> draws_lambda[<span class="dv">37</span><span class="sc">:</span><span class="dv">39</span>,]),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                 <span class="at">Sigma =</span> draws_sigma)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>bvar_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(bvar_est)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>bvar_summary</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; Bayesian VAR model with p = 4 </span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; Model:</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; y ~ invest.01 + income.01 + cons.01 + invest.02 + income.02 + cons.02 + invest.03 + income.03 + cons.03 + invest.04 + income.04 + cons.04 + const</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; Variable: invest </span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt;                Mean      SD  Naive SD Time-series SD      2.5%       50%</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; invest.01 -0.102678 0.13826 0.0013826      0.0067122 -0.411837 -0.016493</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; income.01  0.030302 0.17083 0.0017083      0.0034326 -0.124401  0.008322</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; cons.01    0.095132 0.32165 0.0032165      0.0100857 -0.156626  0.019395</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="co">#&gt; invest.02 -0.012007 0.05070 0.0005070      0.0012843 -0.187390 -0.002507</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">#&gt; income.02  0.006950 0.14724 0.0014724      0.0017426 -0.156169  0.002443</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#&gt; cons.02    0.021886 0.17860 0.0017860      0.0032578 -0.182990  0.007841</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co">#&gt; invest.03  0.032122 0.07987 0.0007987      0.0025971 -0.026218  0.005942</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="co">#&gt; income.03 -0.007616 0.15335 0.0015335      0.0020519 -0.296980 -0.001926</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="co">#&gt; cons.03   -0.047414 0.21576 0.0021576      0.0044539 -0.724049 -0.013501</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="co">#&gt; invest.04  0.264164 0.15632 0.0015632      0.0098066 -0.009652  0.290565</span></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a><span class="co">#&gt; income.04 -0.055766 0.21719 0.0021719      0.0049718 -0.802918 -0.014542</span></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="co">#&gt; cons.04   -0.021885 0.18660 0.0018660      0.0031490 -0.515568 -0.006293</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="co">#&gt; const      0.013325 0.01208 0.0001208      0.0002352 -0.012475  0.013477</span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a><span class="co">#&gt;             97.5% Incl. prob.</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="co">#&gt; invest.01 0.02130      0.4262</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a><span class="co">#&gt; income.01 0.57057      0.0797</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a><span class="co">#&gt; cons.01   1.20857      0.1305</span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a><span class="co">#&gt; invest.02 0.03014      0.1068</span></span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a><span class="co">#&gt; income.02 0.27650      0.0701</span></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a><span class="co">#&gt; cons.02   0.40729      0.0623</span></span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a><span class="co">#&gt; invest.03 0.28849      0.1870</span></span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a><span class="co">#&gt; income.03 0.19233      0.0763</span></span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a><span class="co">#&gt; cons.03   0.15528      0.0911</span></span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a><span class="co">#&gt; invest.04 0.53103      0.8281</span></span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a><span class="co">#&gt; income.04 0.12295      0.1135</span></span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a><span class="co">#&gt; cons.04   0.16283      0.0797</span></span>
<span id="cb5-47"><a href="#cb5-47" tabindex="-1"></a><span class="co">#&gt; const     0.03766      1.0000</span></span>
<span id="cb5-48"><a href="#cb5-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-49"><a href="#cb5-49" tabindex="-1"></a><span class="co">#&gt; Variable: income </span></span>
<span id="cb5-50"><a href="#cb5-50" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-51"><a href="#cb5-51" tabindex="-1"></a><span class="co">#&gt;                 Mean       SD  Naive SD Time-series SD      2.5%        50%</span></span>
<span id="cb5-52"><a href="#cb5-52" tabindex="-1"></a><span class="co">#&gt; invest.01  9.956e-03 0.021913 2.191e-04      7.948e-04 -0.006260  1.827e-03</span></span>
<span id="cb5-53"><a href="#cb5-53" tabindex="-1"></a><span class="co">#&gt; income.01 -2.366e-02 0.085353 8.535e-04      4.298e-03 -0.313599 -3.453e-03</span></span>
<span id="cb5-54"><a href="#cb5-54" tabindex="-1"></a><span class="co">#&gt; cons.01    1.308e-01 0.190136 1.901e-03      1.324e-02 -0.033440  2.252e-02</span></span>
<span id="cb5-55"><a href="#cb5-55" tabindex="-1"></a><span class="co">#&gt; invest.02  1.851e-03 0.011114 1.111e-04      2.645e-04 -0.008256  4.361e-04</span></span>
<span id="cb5-56"><a href="#cb5-56" tabindex="-1"></a><span class="co">#&gt; income.02  4.504e-03 0.041084 4.108e-04      6.930e-04 -0.037925  1.644e-03</span></span>
<span id="cb5-57"><a href="#cb5-57" tabindex="-1"></a><span class="co">#&gt; cons.02   -6.459e-04 0.037967 3.797e-04      4.375e-04 -0.054470 -4.947e-04</span></span>
<span id="cb5-58"><a href="#cb5-58" tabindex="-1"></a><span class="co">#&gt; invest.03 -6.077e-05 0.008284 8.284e-05      9.137e-05 -0.012292 -3.118e-05</span></span>
<span id="cb5-59"><a href="#cb5-59" tabindex="-1"></a><span class="co">#&gt; income.03  1.780e-02 0.060741 6.074e-04      2.057e-03 -0.031838  4.959e-03</span></span>
<span id="cb5-60"><a href="#cb5-60" tabindex="-1"></a><span class="co">#&gt; cons.03    6.922e-03 0.049219 4.922e-04      9.647e-04 -0.047575  2.479e-03</span></span>
<span id="cb5-61"><a href="#cb5-61" tabindex="-1"></a><span class="co">#&gt; invest.04  1.925e-03 0.010591 1.059e-04      2.051e-04 -0.008012  4.585e-04</span></span>
<span id="cb5-62"><a href="#cb5-62" tabindex="-1"></a><span class="co">#&gt; income.04 -1.114e-02 0.045967 4.597e-04      1.077e-03 -0.165655 -3.475e-03</span></span>
<span id="cb5-63"><a href="#cb5-63" tabindex="-1"></a><span class="co">#&gt; cons.04    1.297e-03 0.034280 3.428e-04      3.310e-04 -0.043869  7.042e-04</span></span>
<span id="cb5-64"><a href="#cb5-64" tabindex="-1"></a><span class="co">#&gt; const      1.742e-02 0.003922 3.922e-05      1.701e-04  0.008960  1.802e-02</span></span>
<span id="cb5-65"><a href="#cb5-65" tabindex="-1"></a><span class="co">#&gt;             97.5% Incl. prob.</span></span>
<span id="cb5-66"><a href="#cb5-66" tabindex="-1"></a><span class="co">#&gt; invest.01 0.07729      0.2167</span></span>
<span id="cb5-67"><a href="#cb5-67" tabindex="-1"></a><span class="co">#&gt; income.01 0.03551      0.1404</span></span>
<span id="cb5-68"><a href="#cb5-68" tabindex="-1"></a><span class="co">#&gt; cons.01   0.58572      0.3881</span></span>
<span id="cb5-69"><a href="#cb5-69" tabindex="-1"></a><span class="co">#&gt; invest.02 0.03535      0.0842</span></span>
<span id="cb5-70"><a href="#cb5-70" tabindex="-1"></a><span class="co">#&gt; income.02 0.09878      0.0715</span></span>
<span id="cb5-71"><a href="#cb5-71" tabindex="-1"></a><span class="co">#&gt; cons.02   0.05278      0.0506</span></span>
<span id="cb5-72"><a href="#cb5-72" tabindex="-1"></a><span class="co">#&gt; invest.03 0.01080      0.0706</span></span>
<span id="cb5-73"><a href="#cb5-73" tabindex="-1"></a><span class="co">#&gt; income.03 0.23046      0.1069</span></span>
<span id="cb5-74"><a href="#cb5-74" tabindex="-1"></a><span class="co">#&gt; cons.03   0.13588      0.0752</span></span>
<span id="cb5-75"><a href="#cb5-75" tabindex="-1"></a><span class="co">#&gt; invest.04 0.03454      0.0965</span></span>
<span id="cb5-76"><a href="#cb5-76" tabindex="-1"></a><span class="co">#&gt; income.04 0.03167      0.0934</span></span>
<span id="cb5-77"><a href="#cb5-77" tabindex="-1"></a><span class="co">#&gt; cons.04   0.04732      0.0553</span></span>
<span id="cb5-78"><a href="#cb5-78" tabindex="-1"></a><span class="co">#&gt; const     0.02394      1.0000</span></span>
<span id="cb5-79"><a href="#cb5-79" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-80"><a href="#cb5-80" tabindex="-1"></a><span class="co">#&gt; Variable: cons </span></span>
<span id="cb5-81"><a href="#cb5-81" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-82"><a href="#cb5-82" tabindex="-1"></a><span class="co">#&gt;                 Mean       SD  Naive SD Time-series SD      2.5%        50%</span></span>
<span id="cb5-83"><a href="#cb5-83" tabindex="-1"></a><span class="co">#&gt; invest.01 -0.0019158 0.009862 9.862e-05      2.629e-04 -0.033258 -4.062e-04</span></span>
<span id="cb5-84"><a href="#cb5-84" tabindex="-1"></a><span class="co">#&gt; income.01  0.1557165 0.140919 1.409e-03      1.107e-02 -0.015750  1.699e-01</span></span>
<span id="cb5-85"><a href="#cb5-85" tabindex="-1"></a><span class="co">#&gt; cons.01   -0.2704923 0.197753 1.978e-03      1.768e-02 -0.596806 -3.102e-01</span></span>
<span id="cb5-86"><a href="#cb5-86" tabindex="-1"></a><span class="co">#&gt; invest.02  0.0055334 0.015130 1.513e-04      5.850e-04 -0.005640  1.104e-03</span></span>
<span id="cb5-87"><a href="#cb5-87" tabindex="-1"></a><span class="co">#&gt; income.02  0.3056906 0.100301 1.003e-03      4.675e-03  0.013740  3.133e-01</span></span>
<span id="cb5-88"><a href="#cb5-88" tabindex="-1"></a><span class="co">#&gt; cons.02    0.0098651 0.055799 5.580e-04      3.613e-03 -0.040072  2.129e-03</span></span>
<span id="cb5-89"><a href="#cb5-89" tabindex="-1"></a><span class="co">#&gt; invest.03  0.0003352 0.006858 6.858e-05      8.552e-05 -0.007689  6.655e-05</span></span>
<span id="cb5-90"><a href="#cb5-90" tabindex="-1"></a><span class="co">#&gt; income.03  0.0106024 0.043671 4.367e-04      1.472e-03 -0.026945  2.755e-03</span></span>
<span id="cb5-91"><a href="#cb5-91" tabindex="-1"></a><span class="co">#&gt; cons.03    0.0211561 0.062100 6.210e-04      1.952e-03 -0.029379  5.506e-03</span></span>
<span id="cb5-92"><a href="#cb5-92" tabindex="-1"></a><span class="co">#&gt; invest.04 -0.0040890 0.012678 1.268e-04      3.930e-04 -0.048091 -8.160e-04</span></span>
<span id="cb5-93"><a href="#cb5-93" tabindex="-1"></a><span class="co">#&gt; income.04  0.0258709 0.061971 6.197e-04      2.026e-03 -0.022137  5.951e-03</span></span>
<span id="cb5-94"><a href="#cb5-94" tabindex="-1"></a><span class="co">#&gt; cons.04   -0.0001850 0.030872 3.087e-04      4.057e-04 -0.046276  3.982e-05</span></span>
<span id="cb5-95"><a href="#cb5-95" tabindex="-1"></a><span class="co">#&gt; const      0.0140811 0.003528 3.528e-05      1.058e-04  0.007062  1.407e-02</span></span>
<span id="cb5-96"><a href="#cb5-96" tabindex="-1"></a><span class="co">#&gt;              97.5% Incl. prob.</span></span>
<span id="cb5-97"><a href="#cb5-97" tabindex="-1"></a><span class="co">#&gt; invest.01 0.006557      0.1047</span></span>
<span id="cb5-98"><a href="#cb5-98" tabindex="-1"></a><span class="co">#&gt; income.01 0.408675      0.6205</span></span>
<span id="cb5-99"><a href="#cb5-99" tabindex="-1"></a><span class="co">#&gt; cons.01   0.018590      0.7312</span></span>
<span id="cb5-100"><a href="#cb5-100" tabindex="-1"></a><span class="co">#&gt; invest.02 0.055340      0.1609</span></span>
<span id="cb5-101"><a href="#cb5-101" tabindex="-1"></a><span class="co">#&gt; income.02 0.482837      0.9685</span></span>
<span id="cb5-102"><a href="#cb5-102" tabindex="-1"></a><span class="co">#&gt; cons.02   0.187899      0.0879</span></span>
<span id="cb5-103"><a href="#cb5-103" tabindex="-1"></a><span class="co">#&gt; invest.03 0.012455      0.0711</span></span>
<span id="cb5-104"><a href="#cb5-104" tabindex="-1"></a><span class="co">#&gt; income.03 0.159233      0.1018</span></span>
<span id="cb5-105"><a href="#cb5-105" tabindex="-1"></a><span class="co">#&gt; cons.03   0.230200      0.1362</span></span>
<span id="cb5-106"><a href="#cb5-106" tabindex="-1"></a><span class="co">#&gt; invest.04 0.005295      0.1339</span></span>
<span id="cb5-107"><a href="#cb5-107" tabindex="-1"></a><span class="co">#&gt; income.04 0.222811      0.1825</span></span>
<span id="cb5-108"><a href="#cb5-108" tabindex="-1"></a><span class="co">#&gt; cons.04   0.040838      0.0689</span></span>
<span id="cb5-109"><a href="#cb5-109" tabindex="-1"></a><span class="co">#&gt; const     0.021018      1.0000</span></span>
<span id="cb5-110"><a href="#cb5-110" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-111"><a href="#cb5-111" tabindex="-1"></a><span class="co">#&gt; Variance-covariance matrix:</span></span>
<span id="cb5-112"><a href="#cb5-112" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-113"><a href="#cb5-113" tabindex="-1"></a><span class="co">#&gt;                    Mean        SD  Naive SD Time-series SD       2.5%       50%</span></span>
<span id="cb5-114"><a href="#cb5-114" tabindex="-1"></a><span class="co">#&gt; invest_invest 2.185e-03 3.999e-04 3.999e-06      6.265e-06  1.532e-03 2.142e-03</span></span>
<span id="cb5-115"><a href="#cb5-115" tabindex="-1"></a><span class="co">#&gt; invest_income 4.850e-05 7.491e-05 7.491e-07      9.895e-07 -9.693e-05 4.608e-05</span></span>
<span id="cb5-116"><a href="#cb5-116" tabindex="-1"></a><span class="co">#&gt; invest_cons   1.402e-04 6.155e-05 6.155e-07      7.129e-07  2.726e-05 1.363e-04</span></span>
<span id="cb5-117"><a href="#cb5-117" tabindex="-1"></a><span class="co">#&gt; income_invest 4.850e-05 7.491e-05 7.491e-07      9.895e-07 -9.693e-05 4.608e-05</span></span>
<span id="cb5-118"><a href="#cb5-118" tabindex="-1"></a><span class="co">#&gt; income_income 1.513e-04 2.695e-05 2.695e-07      2.843e-07  1.068e-04 1.484e-04</span></span>
<span id="cb5-119"><a href="#cb5-119" tabindex="-1"></a><span class="co">#&gt; income_cons   6.660e-05 1.781e-05 1.781e-07      2.403e-07  3.610e-05 6.500e-05</span></span>
<span id="cb5-120"><a href="#cb5-120" tabindex="-1"></a><span class="co">#&gt; cons_invest   1.402e-04 6.155e-05 6.155e-07      7.129e-07  2.726e-05 1.363e-04</span></span>
<span id="cb5-121"><a href="#cb5-121" tabindex="-1"></a><span class="co">#&gt; cons_income   6.660e-05 1.781e-05 1.781e-07      2.403e-07  3.610e-05 6.500e-05</span></span>
<span id="cb5-122"><a href="#cb5-122" tabindex="-1"></a><span class="co">#&gt; cons_cons     9.778e-05 1.799e-05 1.799e-07      3.400e-07  6.843e-05 9.601e-05</span></span>
<span id="cb5-123"><a href="#cb5-123" tabindex="-1"></a><span class="co">#&gt;                   97.5%</span></span>
<span id="cb5-124"><a href="#cb5-124" tabindex="-1"></a><span class="co">#&gt; invest_invest 0.0030856</span></span>
<span id="cb5-125"><a href="#cb5-125" tabindex="-1"></a><span class="co">#&gt; invest_income 0.0002018</span></span>
<span id="cb5-126"><a href="#cb5-126" tabindex="-1"></a><span class="co">#&gt; invest_cons   0.0002725</span></span>
<span id="cb5-127"><a href="#cb5-127" tabindex="-1"></a><span class="co">#&gt; income_invest 0.0002018</span></span>
<span id="cb5-128"><a href="#cb5-128" tabindex="-1"></a><span class="co">#&gt; income_income 0.0002132</span></span>
<span id="cb5-129"><a href="#cb5-129" tabindex="-1"></a><span class="co">#&gt; income_cons   0.0001062</span></span>
<span id="cb5-130"><a href="#cb5-130" tabindex="-1"></a><span class="co">#&gt; cons_invest   0.0002725</span></span>
<span id="cb5-131"><a href="#cb5-131" tabindex="-1"></a><span class="co">#&gt; cons_income   0.0001062</span></span>
<span id="cb5-132"><a href="#cb5-132" tabindex="-1"></a><span class="co">#&gt; cons_cons     0.0001381</span></span></code></pre></div>
<p>The inclusion probabilities of the constant terms are 100 percent,
because they were excluded from SSVS.</p>
<p>Using the results from above the researcher could proceed in the
usual way and obtain forecasts and impulse responses based on the output
of the Gibbs sampler. The advantage of this approach is that it does not
only take into account parameter uncertainty, but also model
uncertainty. This can be illustrated by the histogram of the posterior
draws of the 6th coefficient, which describes the relationship between
the first lag of income and the current value of consumption.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">hist</span>(draws_a[<span class="dv">6</span>,], <span class="at">main =</span> <span class="st">&quot;Consumption ~ First lag of income&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Value of posterior draw&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A non-negligible mass of some 23 percent, i.e. 1 - 0.67, of the
parameter draws is concentrated around zero. This is the result of SSVS,
where posterior draws are close to zero if a constant is assessed to be
irrelevant during an iteration of the Gibbs sampler and, therefore,
<span class="math inline">\(\tau_{0,6}^2\)</span> is used as its prior
variance. On the other hand, about 67 percent of the draws are dispersed
around a positive value, where SSVS suggests to include the variable in
the model and the larger value <span class="math inline">\(\tau_{1,6}^2\)</span> is used as prior variance.
Model uncertainty is then described by the two peaks and parameter
uncertainty by the dispersion of the posterior draws around them.</p>
<p>However, if the researcher prefers not to work with a model, where
the relevance of a variable can change from one step of the sampling
algorithm to the next, a different approach would be to work only with a
highly probable model. This can be done with a further simulation, where
very tight priors are used for irrelevant variables and relatively
uninformative priors for relevant parameters. In this example,
coefficients with a posterior inclusion probability of above 40 percent
are considered to be relevant.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> The prior variance is set to 0.00001 for
irrelevant and to 9 for relevant variables. No additional SSVS step is
required. Everything else remains unchanged.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Get inclusion probabilities</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> bvar_summary<span class="sc">$</span>coefficients<span class="sc">$</span>lambda</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># Select variables that should be included</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>include_var <span class="ot">&lt;-</span> <span class="fu">c</span>(lambda <span class="sc">&gt;=</span> .<span class="dv">4</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co"># Update prior variances</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="fu">diag</span>(a_v_i_prior)[<span class="sc">!</span>include_var] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fl">0.00001</span> <span class="co"># Very tight prior close to zero</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="fu">diag</span>(a_v_i_prior)[include_var] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">9</span> <span class="co"># Relatively uninformative prior</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co"># Data containers for posterior draws</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>draws_a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, m, iterations)</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>draws_sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, k<span class="sc">^</span><span class="dv">2</span>, iterations)</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co"># Start Gibbs sampler</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="cf">for</span> (draw <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>draws) {</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>  <span class="co"># Draw conditional mean parameters</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">post_normal</span>(y, x, u_sigma_i, a_mu_prior, a_v_i_prior)</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>  </span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>  <span class="co"># Draw variance-covariance matrix</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>  u <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">matrix</span>(a, k) <span class="sc">%*%</span> x <span class="co"># Obtain residuals</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>  u_sigma_scale_post <span class="ot">&lt;-</span> <span class="fu">solve</span>(u_sigma_scale_prior <span class="sc">+</span> <span class="fu">tcrossprod</span>(u))</span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>  u_sigma_i <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rWishart</span>(<span class="dv">1</span>, u_sigma_df_post, u_sigma_scale_post)[,, <span class="dv">1</span>], k)</span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>  u_sigma <span class="ot">&lt;-</span> <span class="fu">solve</span>(u_sigma_i) <span class="co"># Invert Sigma_i to obtain Sigma</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>  </span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>  <span class="co"># Store draws</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>  <span class="cf">if</span> (draw <span class="sc">&gt;</span> burnin) {</span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>    draws_a[, draw <span class="sc">-</span> burnin] <span class="ot">&lt;-</span> a</span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a>    draws_sigma[, draw <span class="sc">-</span> burnin] <span class="ot">&lt;-</span> u_sigma</span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a>  }</span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a>}</span></code></pre></div>
<p>The means of the posterior draws are similar to the OLS estimates in
Lütkepohl (2006, Section 5.2.10):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>bvar_est <span class="ot">&lt;-</span> <span class="fu">bvar</span>(<span class="at">y =</span> data<span class="sc">$</span>data<span class="sc">$</span>Y, <span class="at">x =</span> data<span class="sc">$</span>data<span class="sc">$</span>Z, <span class="at">A =</span> draws_a[<span class="dv">1</span><span class="sc">:</span><span class="dv">36</span>,],</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                 <span class="at">C =</span> draws_a[<span class="dv">37</span><span class="sc">:</span><span class="dv">39</span>, ], <span class="at">Sigma =</span> draws_sigma)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">summary</span>(bvar_est)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; Bayesian VAR model with p = 4 </span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; Model:</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; y ~ invest.01 + income.01 + cons.01 + invest.02 + income.02 + cons.02 + invest.03 + income.03 + cons.03 + invest.04 + income.04 + cons.04 + const</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; Variable: invest </span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt;                 Mean       SD  Naive SD Time-series SD      2.5%        50%</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; invest.01 -2.273e-01 0.109891 1.099e-03      1.132e-03 -0.442479 -2.280e-01</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; income.01  6.902e-07 0.003206 3.206e-05      3.206e-05 -0.006286 -9.111e-06</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; cons.01   -3.872e-05 0.003141 3.141e-05      3.141e-05 -0.006291 -1.351e-05</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; invest.02 -1.476e-04 0.003188 3.188e-05      3.188e-05 -0.006379 -1.627e-04</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; income.02  1.006e-05 0.003115 3.115e-05      3.115e-05 -0.006058  6.718e-06</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; cons.02    1.298e-05 0.003183 3.183e-05      3.183e-05 -0.006185  7.462e-06</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; invest.03  9.864e-05 0.003181 3.181e-05      3.181e-05 -0.006223  5.629e-05</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; income.03 -4.254e-05 0.003156 3.156e-05      3.238e-05 -0.006291 -1.891e-05</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; cons.03    2.170e-05 0.003148 3.148e-05      3.058e-05 -0.006153  1.975e-05</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt; invest.04  3.267e-01 0.108329 1.083e-03      1.083e-03  0.113552  3.267e-01</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; income.04 -1.611e-05 0.003135 3.135e-05      3.135e-05 -0.006243  8.115e-06</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; cons.04    4.579e-05 0.003154 3.154e-05      3.076e-05 -0.006085  7.562e-05</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; const      1.519e-02 0.006069 6.069e-05      6.069e-05  0.003176  1.523e-02</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt;               97.5%</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; invest.01 -0.013764</span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; income.01  0.006310</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt; cons.01    0.006061</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; invest.02  0.006064</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; income.02  0.006000</span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt; cons.02    0.006263</span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt; invest.03  0.006299</span></span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a><span class="co">#&gt; income.03  0.006131</span></span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a><span class="co">#&gt; cons.03    0.006159</span></span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a><span class="co">#&gt; invest.04  0.536211</span></span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a><span class="co">#&gt; income.04  0.006153</span></span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a><span class="co">#&gt; cons.04    0.006270</span></span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a><span class="co">#&gt; const      0.026959</span></span>
<span id="cb8-42"><a href="#cb8-42" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-43"><a href="#cb8-43" tabindex="-1"></a><span class="co">#&gt; Variable: income </span></span>
<span id="cb8-44"><a href="#cb8-44" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-45"><a href="#cb8-45" tabindex="-1"></a><span class="co">#&gt;                 Mean       SD  Naive SD Time-series SD      2.5%        50%</span></span>
<span id="cb8-46"><a href="#cb8-46" tabindex="-1"></a><span class="co">#&gt; invest.01  6.869e-04 0.003136 3.136e-05      3.193e-05 -0.005465  6.890e-04</span></span>
<span id="cb8-47"><a href="#cb8-47" tabindex="-1"></a><span class="co">#&gt; income.01  1.075e-05 0.003137 3.137e-05      3.160e-05 -0.006210  2.738e-05</span></span>
<span id="cb8-48"><a href="#cb8-48" tabindex="-1"></a><span class="co">#&gt; cons.01    1.151e-04 0.003147 3.147e-05      3.090e-05 -0.005923  1.105e-04</span></span>
<span id="cb8-49"><a href="#cb8-49" tabindex="-1"></a><span class="co">#&gt; invest.02  6.772e-05 0.003097 3.097e-05      3.097e-05 -0.006038  1.310e-04</span></span>
<span id="cb8-50"><a href="#cb8-50" tabindex="-1"></a><span class="co">#&gt; income.02  5.710e-05 0.003196 3.196e-05      3.401e-05 -0.006141  5.508e-05</span></span>
<span id="cb8-51"><a href="#cb8-51" tabindex="-1"></a><span class="co">#&gt; cons.02   -1.453e-05 0.003160 3.160e-05      3.160e-05 -0.006246 -2.748e-05</span></span>
<span id="cb8-52"><a href="#cb8-52" tabindex="-1"></a><span class="co">#&gt; invest.03  5.477e-05 0.003141 3.141e-05      3.141e-05 -0.006140  7.633e-05</span></span>
<span id="cb8-53"><a href="#cb8-53" tabindex="-1"></a><span class="co">#&gt; income.03  1.774e-04 0.003156 3.156e-05      3.156e-05 -0.006066  1.634e-04</span></span>
<span id="cb8-54"><a href="#cb8-54" tabindex="-1"></a><span class="co">#&gt; cons.03    3.008e-05 0.003135 3.135e-05      3.135e-05 -0.006256  4.382e-05</span></span>
<span id="cb8-55"><a href="#cb8-55" tabindex="-1"></a><span class="co">#&gt; invest.04  2.947e-04 0.003174 3.174e-05      3.120e-05 -0.005938  3.048e-04</span></span>
<span id="cb8-56"><a href="#cb8-56" tabindex="-1"></a><span class="co">#&gt; income.04 -4.550e-05 0.003163 3.163e-05      3.163e-05 -0.006330 -1.594e-05</span></span>
<span id="cb8-57"><a href="#cb8-57" tabindex="-1"></a><span class="co">#&gt; cons.04   -3.258e-05 0.003163 3.163e-05      3.163e-05 -0.006236 -6.488e-05</span></span>
<span id="cb8-58"><a href="#cb8-58" tabindex="-1"></a><span class="co">#&gt; const      2.014e-02 0.001479 1.479e-05      1.479e-05  0.017236  2.016e-02</span></span>
<span id="cb8-59"><a href="#cb8-59" tabindex="-1"></a><span class="co">#&gt;              97.5%</span></span>
<span id="cb8-60"><a href="#cb8-60" tabindex="-1"></a><span class="co">#&gt; invest.01 0.006849</span></span>
<span id="cb8-61"><a href="#cb8-61" tabindex="-1"></a><span class="co">#&gt; income.01 0.006054</span></span>
<span id="cb8-62"><a href="#cb8-62" tabindex="-1"></a><span class="co">#&gt; cons.01   0.006304</span></span>
<span id="cb8-63"><a href="#cb8-63" tabindex="-1"></a><span class="co">#&gt; invest.02 0.006066</span></span>
<span id="cb8-64"><a href="#cb8-64" tabindex="-1"></a><span class="co">#&gt; income.02 0.006299</span></span>
<span id="cb8-65"><a href="#cb8-65" tabindex="-1"></a><span class="co">#&gt; cons.02   0.006191</span></span>
<span id="cb8-66"><a href="#cb8-66" tabindex="-1"></a><span class="co">#&gt; invest.03 0.006201</span></span>
<span id="cb8-67"><a href="#cb8-67" tabindex="-1"></a><span class="co">#&gt; income.03 0.006285</span></span>
<span id="cb8-68"><a href="#cb8-68" tabindex="-1"></a><span class="co">#&gt; cons.03   0.006174</span></span>
<span id="cb8-69"><a href="#cb8-69" tabindex="-1"></a><span class="co">#&gt; invest.04 0.006435</span></span>
<span id="cb8-70"><a href="#cb8-70" tabindex="-1"></a><span class="co">#&gt; income.04 0.006075</span></span>
<span id="cb8-71"><a href="#cb8-71" tabindex="-1"></a><span class="co">#&gt; cons.04   0.006140</span></span>
<span id="cb8-72"><a href="#cb8-72" tabindex="-1"></a><span class="co">#&gt; const     0.023037</span></span>
<span id="cb8-73"><a href="#cb8-73" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-74"><a href="#cb8-74" tabindex="-1"></a><span class="co">#&gt; Variable: cons </span></span>
<span id="cb8-75"><a href="#cb8-75" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-76"><a href="#cb8-76" tabindex="-1"></a><span class="co">#&gt;                 Mean       SD  Naive SD Time-series SD      2.5%        50%</span></span>
<span id="cb8-77"><a href="#cb8-77" tabindex="-1"></a><span class="co">#&gt; invest.01 -5.275e-04 0.003134 3.134e-05      3.134e-05 -0.006716 -5.338e-04</span></span>
<span id="cb8-78"><a href="#cb8-78" tabindex="-1"></a><span class="co">#&gt; income.01  2.618e-01 0.085979 8.598e-04      8.924e-04  0.094695  2.612e-01</span></span>
<span id="cb8-79"><a href="#cb8-79" tabindex="-1"></a><span class="co">#&gt; cons.01   -4.362e-01 0.102607 1.026e-03      1.083e-03 -0.638762 -4.368e-01</span></span>
<span id="cb8-80"><a href="#cb8-80" tabindex="-1"></a><span class="co">#&gt; invest.02  6.559e-04 0.003116 3.116e-05      3.116e-05 -0.005524  6.822e-04</span></span>
<span id="cb8-81"><a href="#cb8-81" tabindex="-1"></a><span class="co">#&gt; income.02  3.289e-01 0.076682 7.668e-04      7.837e-04  0.176874  3.294e-01</span></span>
<span id="cb8-82"><a href="#cb8-82" tabindex="-1"></a><span class="co">#&gt; cons.02   -8.815e-06 0.003175 3.175e-05      3.175e-05 -0.006188  6.246e-06</span></span>
<span id="cb8-83"><a href="#cb8-83" tabindex="-1"></a><span class="co">#&gt; invest.03  8.475e-05 0.003139 3.139e-05      3.139e-05 -0.006145  1.200e-04</span></span>
<span id="cb8-84"><a href="#cb8-84" tabindex="-1"></a><span class="co">#&gt; income.03  1.198e-04 0.003193 3.193e-05      3.193e-05 -0.006138  1.262e-04</span></span>
<span id="cb8-85"><a href="#cb8-85" tabindex="-1"></a><span class="co">#&gt; cons.03    1.700e-04 0.003189 3.189e-05      3.286e-05 -0.006022  1.339e-04</span></span>
<span id="cb8-86"><a href="#cb8-86" tabindex="-1"></a><span class="co">#&gt; invest.04 -5.389e-04 0.003125 3.125e-05      3.125e-05 -0.006711 -4.977e-04</span></span>
<span id="cb8-87"><a href="#cb8-87" tabindex="-1"></a><span class="co">#&gt; income.04  1.594e-04 0.003161 3.161e-05      3.161e-05 -0.005997  1.459e-04</span></span>
<span id="cb8-88"><a href="#cb8-88" tabindex="-1"></a><span class="co">#&gt; cons.04    4.326e-05 0.003131 3.131e-05      3.131e-05 -0.006195  7.535e-05</span></span>
<span id="cb8-89"><a href="#cb8-89" tabindex="-1"></a><span class="co">#&gt; const      1.611e-02 0.002675 2.675e-05      2.783e-05  0.010777  1.613e-02</span></span>
<span id="cb8-90"><a href="#cb8-90" tabindex="-1"></a><span class="co">#&gt;               97.5%</span></span>
<span id="cb8-91"><a href="#cb8-91" tabindex="-1"></a><span class="co">#&gt; invest.01  0.005679</span></span>
<span id="cb8-92"><a href="#cb8-92" tabindex="-1"></a><span class="co">#&gt; income.01  0.431811</span></span>
<span id="cb8-93"><a href="#cb8-93" tabindex="-1"></a><span class="co">#&gt; cons.01   -0.233266</span></span>
<span id="cb8-94"><a href="#cb8-94" tabindex="-1"></a><span class="co">#&gt; invest.02  0.006694</span></span>
<span id="cb8-95"><a href="#cb8-95" tabindex="-1"></a><span class="co">#&gt; income.02  0.479725</span></span>
<span id="cb8-96"><a href="#cb8-96" tabindex="-1"></a><span class="co">#&gt; cons.02    0.006226</span></span>
<span id="cb8-97"><a href="#cb8-97" tabindex="-1"></a><span class="co">#&gt; invest.03  0.006270</span></span>
<span id="cb8-98"><a href="#cb8-98" tabindex="-1"></a><span class="co">#&gt; income.03  0.006302</span></span>
<span id="cb8-99"><a href="#cb8-99" tabindex="-1"></a><span class="co">#&gt; cons.03    0.006470</span></span>
<span id="cb8-100"><a href="#cb8-100" tabindex="-1"></a><span class="co">#&gt; invest.04  0.005557</span></span>
<span id="cb8-101"><a href="#cb8-101" tabindex="-1"></a><span class="co">#&gt; income.04  0.006426</span></span>
<span id="cb8-102"><a href="#cb8-102" tabindex="-1"></a><span class="co">#&gt; cons.04    0.006137</span></span>
<span id="cb8-103"><a href="#cb8-103" tabindex="-1"></a><span class="co">#&gt; const      0.021319</span></span>
<span id="cb8-104"><a href="#cb8-104" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-105"><a href="#cb8-105" tabindex="-1"></a><span class="co">#&gt; Variance-covariance matrix:</span></span>
<span id="cb8-106"><a href="#cb8-106" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-107"><a href="#cb8-107" tabindex="-1"></a><span class="co">#&gt;                    Mean        SD  Naive SD Time-series SD       2.5%       50%</span></span>
<span id="cb8-108"><a href="#cb8-108" tabindex="-1"></a><span class="co">#&gt; invest_invest 2.091e-03 3.726e-04 3.726e-06      3.857e-06  1.487e-03 2.051e-03</span></span>
<span id="cb8-109"><a href="#cb8-109" tabindex="-1"></a><span class="co">#&gt; invest_income 6.378e-05 7.091e-05 7.091e-07      7.335e-07 -7.152e-05 6.190e-05</span></span>
<span id="cb8-110"><a href="#cb8-110" tabindex="-1"></a><span class="co">#&gt; invest_cons   1.383e-04 5.890e-05 5.890e-07      6.105e-07  3.342e-05 1.342e-04</span></span>
<span id="cb8-111"><a href="#cb8-111" tabindex="-1"></a><span class="co">#&gt; income_invest 6.378e-05 7.091e-05 7.091e-07      7.335e-07 -7.152e-05 6.190e-05</span></span>
<span id="cb8-112"><a href="#cb8-112" tabindex="-1"></a><span class="co">#&gt; income_income 1.529e-04 2.713e-05 2.713e-07      2.774e-07  1.081e-04 1.497e-04</span></span>
<span id="cb8-113"><a href="#cb8-113" tabindex="-1"></a><span class="co">#&gt; income_cons   6.897e-05 1.762e-05 1.762e-07      1.868e-07  3.912e-05 6.726e-05</span></span>
<span id="cb8-114"><a href="#cb8-114" tabindex="-1"></a><span class="co">#&gt; cons_invest   1.383e-04 5.890e-05 5.890e-07      6.105e-07  3.342e-05 1.342e-04</span></span>
<span id="cb8-115"><a href="#cb8-115" tabindex="-1"></a><span class="co">#&gt; cons_income   6.897e-05 1.762e-05 1.762e-07      1.868e-07  3.912e-05 6.726e-05</span></span>
<span id="cb8-116"><a href="#cb8-116" tabindex="-1"></a><span class="co">#&gt; cons_cons     9.637e-05 1.758e-05 1.758e-07      1.903e-07  6.789e-05 9.434e-05</span></span>
<span id="cb8-117"><a href="#cb8-117" tabindex="-1"></a><span class="co">#&gt;                   97.5%</span></span>
<span id="cb8-118"><a href="#cb8-118" tabindex="-1"></a><span class="co">#&gt; invest_invest 0.0029372</span></span>
<span id="cb8-119"><a href="#cb8-119" tabindex="-1"></a><span class="co">#&gt; invest_income 0.0002109</span></span>
<span id="cb8-120"><a href="#cb8-120" tabindex="-1"></a><span class="co">#&gt; invest_cons   0.0002659</span></span>
<span id="cb8-121"><a href="#cb8-121" tabindex="-1"></a><span class="co">#&gt; income_invest 0.0002109</span></span>
<span id="cb8-122"><a href="#cb8-122" tabindex="-1"></a><span class="co">#&gt; income_income 0.0002144</span></span>
<span id="cb8-123"><a href="#cb8-123" tabindex="-1"></a><span class="co">#&gt; income_cons   0.0001085</span></span>
<span id="cb8-124"><a href="#cb8-124" tabindex="-1"></a><span class="co">#&gt; cons_invest   0.0002659</span></span>
<span id="cb8-125"><a href="#cb8-125" tabindex="-1"></a><span class="co">#&gt; cons_income   0.0001085</span></span>
<span id="cb8-126"><a href="#cb8-126" tabindex="-1"></a><span class="co">#&gt; cons_cons     0.0001354</span></span></code></pre></div>
<p>Forecasts, impulse responses and variance decompositions can be
obtained in the usual manner.</p>
</div>
<div id="using-the-built-in-simulation-algorithm-of-bvartools" class="section level2">
<h2>Using the built-in simulation algorithm of
<code>bvartools</code></h2>
<p>Priors can be added to object <code>data</code> using function
<code>add_priors</code>. To use the same specification as above,
argument <code>ssvs</code> is a named list, where element
<code>inprior</code> contains the prior probability that a coefficient
enters a model, element <code>semiautomatic</code> contains the factors
used to obtain <span class="math inline">\(tau_0\)</span> and <span class="math inline">\(tau_1\)</span> based on the semiautomatic approach
of George et al. (2008) and <code>exclude_det = TRUE</code> tells the
algorithm to exclude deterministic terms from the SSVS algorithm.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Obtain priors</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>model_with_priors <span class="ot">&lt;-</span> <span class="fu">add_priors</span>(data,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                                <span class="at">ssvs =</span> <span class="fu">list</span>(<span class="at">inprior =</span> <span class="fl">0.5</span>, <span class="at">semiautomatic =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">10</span>), <span class="at">exclude_det =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                                <span class="at">sigma =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="fl">0.00001</span>))</span></code></pre></div>
<p>Posterior draws can be obtained using function
<code>draw_posterior</code>. It will recognise the specifications of the
model based on the content of object <code>model_with_priors</code> and
produce the respective draws from the posterior.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>ssvs_est <span class="ot">&lt;-</span> <span class="fu">draw_posterior</span>(model_with_priors)</span></code></pre></div>
<p>The output of <code>draw_posterior</code> is an object of class
<code>bvar</code>. Thus, further analytical steps can be done as
described above.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Chan, J., Koop, G., Poirier, D. J., &amp; Tobias, J. L. (2019).
<em>Bayesian Econometric Methods</em> (2nd ed.). Cambridge: University
Press.</p>
<p>George, E. I., Sun, D., &amp; Ni, S. (2008). Bayesian stochastic
search for VAR model restrictions. <em>Journal of Econometrics,
142</em>(1), 553-580. <a href="https://doi.org/10.1016/j.jeconom.2007.08.017" class="uri">https://doi.org/10.1016/j.jeconom.2007.08.017</a></p>
<p>Koop, G., &amp; Korobilis, D. (2010). Bayesian multivariate time
series methods for empirical macroeconomics. <em>Foundations and trends
in econometrics, 3</em>(4), 267-358. <a href="https://dx.doi.org/10.1561/0800000013" class="uri">https://dx.doi.org/10.1561/0800000013</a></p>
<p>Korobilis, D. (2013). VAR forecasting using Bayesian variable
selection. <em>Journal of Applied Econometrics, 28</em>(2), 204-230. <a href="https://doi.org/10.1002/jae.1271" class="uri">https://doi.org/10.1002/jae.1271</a></p>
<p>Lütkepohl, H. (2006). <em>New introduction to multiple time series
analysis</em> (2nd ed.). Berlin: Springer.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>See Koop and Korobilis (2010) for an introduction to
Bayesian VAR modelling and SSVS.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>This threshold value is usually set to 50 percent. 40
percent is chosen, because it yields similar results as the restricted
model in Lütkepohl (2006, Section 5.2.10).<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
